{"ast":null,"code":"import { atom } from \"recoil\";\nimport { recoilPersist } from \"recoil-persist\";\nconst {\n  persistAtom\n} = recoilPersist();\nexport const toDoState = atom({\n  key: \"toDo\",\n  default: {\n    \"To Do\": [],\n    Doing: [],\n    Done: []\n  },\n  effects_UNSTABLE: [persistAtom],\n  effects: [localStorageEffect(\"trello-clone-to-dos\")]\n});\nexport const boardState = atom({\n  key: \"boards\",\n  default: [\"To Do\", \"Doing\", \"Done\"],\n  effects_UNSTABLE: [persistAtom]\n});\nexport const isLightState = atom({\n  key: \"isLight\",\n  default: window.matchMedia(\"(prefers-color-scheme: light)\").matches ? true : false\n});\nconst instanceOfToDo = object => {\n  return object.constructor === Object && \"id\" in object && \"text\" in object && typeof object.id === \"number\" && typeof object.text === \"string\";\n};\nconst instanceOfBoard = object => {\n  return object.constructor === Object && \"id\" in object && \"title\" in object && \"toDos\" in object && typeof object.id === \"number\" && typeof object.title === \"string\" && object.toDos.every(toDo => instanceOfToDo(toDo));\n};\nconst instanceOfBoards = object => {\n  return Array.isArray(object) && object.every(board => instanceOfBoard(board));\n};\nconst localStorageEffect = key => _ref => {\n  let {\n    setSelf,\n    onSet\n  } = _ref;\n  const savedValue = localStorage.getItem(key);\n  if (savedValue !== null && savedValue !== undefined) {\n    const json = raw => {\n      try {\n        return JSON.parse(raw);\n      } catch (error) {\n        return false;\n      }\n    };\n    if (json(savedValue) && instanceOfBoards(json(savedValue))) {\n      setSelf(json(savedValue));\n    }\n  }\n  onSet(newValue => {\n    localStorage.setItem(key, JSON.stringify(newValue));\n  });\n};","map":{"version":3,"names":["atom","recoilPersist","persistAtom","toDoState","key","default","Doing","Done","effects_UNSTABLE","effects","localStorageEffect","boardState","isLightState","window","matchMedia","matches","instanceOfToDo","object","constructor","Object","id","text","instanceOfBoard","title","toDos","every","toDo","instanceOfBoards","Array","isArray","board","setSelf","onSet","savedValue","localStorage","getItem","undefined","json","raw","JSON","parse","error","newValue","setItem","stringify"],"sources":["/Users/kwak/Documents/study/멋사/Likelion_hufs10th/react-masterclass/src/atom.ts"],"sourcesContent":["import { atom } from \"recoil\";\nimport { recoilPersist } from \"recoil-persist\";\n\nconst { persistAtom } = recoilPersist();\n\nexport interface IToDo {\n  id: number;\n  text: string;\n}\n\nexport interface IToDoState {\n  // consider scalability\n  [key: string]: IToDo[];\n}\n\nexport interface IBoard {\n  id: number;\n  title: string;\n  toDos: IToDo[];\n}\n\nexport const toDoState = atom<IToDoState>({\n  key: \"toDo\",\n  default: {\n    \"To Do\": [],\n    Doing: [],\n    Done: [],\n  },\n  effects_UNSTABLE: [persistAtom],\n  effects: [localStorageEffect(\"trello-clone-to-dos\")],\n});\n\nexport const boardState = atom<string[]>({\n  key: \"boards\",\n  default: [\"To Do\", \"Doing\", \"Done\"],\n  effects_UNSTABLE: [persistAtom],\n});\n\nexport const isLightState = atom<boolean>({\n  key: \"isLight\",\n  default: window.matchMedia(\"(prefers-color-scheme: light)\").matches\n    ? true\n    : false,\n});\n\nconst instanceOfToDo = (object: any): object is IToDo => {\n  return (\n    object.constructor === Object &&\n    \"id\" in object &&\n    \"text\" in object &&\n    typeof (object as IToDo).id === \"number\" &&\n    typeof (object as IToDo).text === \"string\"\n  );\n};\n\nconst instanceOfBoard = (object: any): object is IBoard => {\n  return (\n    object.constructor === Object &&\n    \"id\" in object &&\n    \"title\" in object &&\n    \"toDos\" in object &&\n    typeof (object as IBoard).id === \"number\" &&\n    typeof (object as IBoard).title === \"string\" &&\n    (object as IBoard).toDos.every((toDo) => instanceOfToDo(toDo))\n  );\n};\n\nconst instanceOfBoards = (object: any): object is IBoard[] => {\n  return (\n    Array.isArray(object) &&\n    (object as IBoard[]).every((board) => instanceOfBoard(board))\n  );\n};\n\nconst localStorageEffect =\n  (key: string) =>\n  ({ setSelf, onSet }: any) => {\n    const savedValue = localStorage.getItem(key);\n\n    if (savedValue !== null && savedValue !== undefined) {\n      const json = (raw: string) => {\n        try {\n          return JSON.parse(raw);\n        } catch (error) {\n          return false;\n        }\n      };\n\n      if (json(savedValue) && instanceOfBoards(json(savedValue))) {\n        setSelf(json(savedValue));\n      }\n    }\n\n    onSet((newValue: IBoard[]) => {\n      localStorage.setItem(key, JSON.stringify(newValue));\n    });\n  };\n"],"mappings":"AAAA,SAASA,IAAI,QAAQ,QAAQ;AAC7B,SAASC,aAAa,QAAQ,gBAAgB;AAE9C,MAAM;EAAEC;AAAY,CAAC,GAAGD,aAAa,EAAE;AAkBvC,OAAO,MAAME,SAAS,GAAGH,IAAI,CAAa;EACxCI,GAAG,EAAE,MAAM;EACXC,OAAO,EAAE;IACP,OAAO,EAAE,EAAE;IACXC,KAAK,EAAE,EAAE;IACTC,IAAI,EAAE;EACR,CAAC;EACDC,gBAAgB,EAAE,CAACN,WAAW,CAAC;EAC/BO,OAAO,EAAE,CAACC,kBAAkB,CAAC,qBAAqB,CAAC;AACrD,CAAC,CAAC;AAEF,OAAO,MAAMC,UAAU,GAAGX,IAAI,CAAW;EACvCI,GAAG,EAAE,QAAQ;EACbC,OAAO,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,MAAM,CAAC;EACnCG,gBAAgB,EAAE,CAACN,WAAW;AAChC,CAAC,CAAC;AAEF,OAAO,MAAMU,YAAY,GAAGZ,IAAI,CAAU;EACxCI,GAAG,EAAE,SAAS;EACdC,OAAO,EAAEQ,MAAM,CAACC,UAAU,CAAC,+BAA+B,CAAC,CAACC,OAAO,GAC/D,IAAI,GACJ;AACN,CAAC,CAAC;AAEF,MAAMC,cAAc,GAAIC,MAAW,IAAsB;EACvD,OACEA,MAAM,CAACC,WAAW,KAAKC,MAAM,IAC7B,IAAI,IAAIF,MAAM,IACd,MAAM,IAAIA,MAAM,IAChB,OAAQA,MAAM,CAAWG,EAAE,KAAK,QAAQ,IACxC,OAAQH,MAAM,CAAWI,IAAI,KAAK,QAAQ;AAE9C,CAAC;AAED,MAAMC,eAAe,GAAIL,MAAW,IAAuB;EACzD,OACEA,MAAM,CAACC,WAAW,KAAKC,MAAM,IAC7B,IAAI,IAAIF,MAAM,IACd,OAAO,IAAIA,MAAM,IACjB,OAAO,IAAIA,MAAM,IACjB,OAAQA,MAAM,CAAYG,EAAE,KAAK,QAAQ,IACzC,OAAQH,MAAM,CAAYM,KAAK,KAAK,QAAQ,IAC3CN,MAAM,CAAYO,KAAK,CAACC,KAAK,CAAEC,IAAI,IAAKV,cAAc,CAACU,IAAI,CAAC,CAAC;AAElE,CAAC;AAED,MAAMC,gBAAgB,GAAIV,MAAW,IAAyB;EAC5D,OACEW,KAAK,CAACC,OAAO,CAACZ,MAAM,CAAC,IACpBA,MAAM,CAAcQ,KAAK,CAAEK,KAAK,IAAKR,eAAe,CAACQ,KAAK,CAAC,CAAC;AAEjE,CAAC;AAED,MAAMpB,kBAAkB,GACrBN,GAAW,IACZ,QAA6B;EAAA,IAA5B;IAAE2B,OAAO;IAAEC;EAAW,CAAC;EACtB,MAAMC,UAAU,GAAGC,YAAY,CAACC,OAAO,CAAC/B,GAAG,CAAC;EAE5C,IAAI6B,UAAU,KAAK,IAAI,IAAIA,UAAU,KAAKG,SAAS,EAAE;IACnD,MAAMC,IAAI,GAAIC,GAAW,IAAK;MAC5B,IAAI;QACF,OAAOC,IAAI,CAACC,KAAK,CAACF,GAAG,CAAC;MACxB,CAAC,CAAC,OAAOG,KAAK,EAAE;QACd,OAAO,KAAK;MACd;IACF,CAAC;IAED,IAAIJ,IAAI,CAACJ,UAAU,CAAC,IAAIN,gBAAgB,CAACU,IAAI,CAACJ,UAAU,CAAC,CAAC,EAAE;MAC1DF,OAAO,CAACM,IAAI,CAACJ,UAAU,CAAC,CAAC;IAC3B;EACF;EAEAD,KAAK,CAAEU,QAAkB,IAAK;IAC5BR,YAAY,CAACS,OAAO,CAACvC,GAAG,EAAEmC,IAAI,CAACK,SAAS,CAACF,QAAQ,CAAC,CAAC;EACrD,CAAC,CAAC;AACJ,CAAC"},"metadata":{},"sourceType":"module"}